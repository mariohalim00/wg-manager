# Copilot Commit Message Instructions

## Purpose

Generate **clear, accurate, and minimal commit messages** that reflect _what actually changed and why_, without restating specs, tasks, or obvious diffs.

Commit messages are part of the **project’s long-term memory**. They should help future humans and AI understand intent, constraints, and tradeoffs — not just mechanics.

---

## General Rules

- Be **concise but informative**
- Prefer **intent and impact** over implementation detail
- Do NOT restate:
  - Spec text
  - Ticket titles
  - File diffs line-by-line
- Do NOT invent rationale that is not evident from code or context
- Do NOT use vague messages like:
  - "fix stuff"
  - "updates"
  - "changes"
  - "wip"
- still adhere toi the conventional mcommit message format

---

## Structure

Use the following structure unless explicitly told otherwise:

```
<type>: <short summary>

<context (optional)>
<reasoning or constraint (optional)>
```

### Example

fix: prevent duplicate settlement for concurrent requests

Settlement was previously idempotent only at the API layer.
This change enforces the invariant at the database level to
avoid race conditions under load.

---

## Commit Types (preferred)

Use one of the following prefixes when applicable:

- `feat:` – new user-facing behavior
- `fix:` – bug fix or correctness issue
- `refactor:` – structural change without behavior change
- `perf:` – performance improvement
- `test:` – tests only
- `docs:` – documentation only
- `chore:` – tooling, formatting, maintenance
- `infra:` – build, CI, deployment, environment

If none apply cleanly, omit the prefix rather than guessing.

---

## What to Emphasize

### Prefer mentioning:

- New or changed **invariants**
- Behavioral changes that are **not obvious from code**
- Constraints that influenced the implementation
- Tradeoffs or intentional limitations

### Avoid mentioning:

- Temporary workarounds
- Experimental code paths unless user-facing
- Formatting-only changes (unless significant)

---

## Multi-Change Commits

If a commit includes multiple related changes:

- Summarize the **unifying intent**
- Do not list every sub-change

Bad:

- fix: update handler
- renamed variable
- added check
- updated test

Good:

- fix: enforce validation before persistence
- Centralizes validation logic to ensure invalid states
- cannot be written, even when bypassing the API layer.

---

## Tone

- Appear friendly yet content remains neutral and factual
- use emoji 
- No marketing language
- No first-person (“I”, “we”) unless explicitly requested

---

## When Unsure

If the intent of the change is unclear:

- Ask for clarification
- Or generate a conservative, factual message describing the observable behavior change only

Do not guess motivation.
